<style>
#project-name {
  margin: 2em 0 5px 0;
  color: #888;
}
h1 { margin: 0; }
#progress-context {
  margin-top: 10px;
}
#progress-context > div > div {
  border-top: 2px solid #C5C5C2;
  padding-top: 2px;
  margin-right: 15px;
  color: #C5C5C2;
  font-size: 13px;
  text-transform: uppercase;
}
#progress-context > div.active > div {
  border-top: 2px solid #2556a1;
  color: #1e5281;
}
</style>

<div id="project-name">
  {{task.project.title}}
  {% with supermodule=task.is_answer_to_unique %}
    {% if supermodule %}
      (submodule of {{supermodule.question.task.title}})
    {% endif %}
  {% endwith %}
</div>
<h1>{{task.title}}</h1>

<div id="progress-context" class="row">
  <div class="col-sm-{{col_width}} {% if col_active == "start" %}active{% endif %}">
    <div>Start Module</div>
  </div>

  <div class="col-sm-{{col_width}} {% if col_active == "questions" %}active{% endif %}">
    <div>Answer Questions</div>
  </div>

  <div class="col-sm-{{col_width}} {% if col_active == "review" %}active{% endif %}">
    <div>Review</div>
  </div>
</div>

{% if task.editor == request.user %}
{% with active_invitation_to_transfer_editorship as inv %}
  {% if inv %}
    <div class="panel panel-warning" style="margin-top: 30px">
      <div class="panel-heading">Invitation sent</div>
      <div class="panel-body">
        On {{inv.created|date}} you invited {{inv.to_display}} to take over editing this module. They haven&rsquo;t yet accepted your invitation. You can keep working on it until they accept the invitation.
      </div>
    </div>
  {% endif %}
{% endwith %}

{% else %}
<div class="panel panel-danger" style="margin-top: 30px">
  <div class="panel-heading">Someone else is editing this module</div>
  <div class="panel-body">
    This module is being edited by {{task.editor}}.
    {% if write_priv %}
      But you are a project admin so you can edit it.
    {% else %}
      You cannot make changes to it.
    {% endif %}
  </div>
</div>
{% endif %}

<script>
function invite_to_transfer_editor() {
  var info = {{send_invitation|safe}};
  show_invite_modal(
    'Ask a Colleague',
    'Invite a colleague to complete {{task.title|escapejs}}.',
    info,
    'Can you take over answering {{task.title|escapejs}} for ' + info.project_title + ' and let me know when it is done?',
    {
      project: info.project_id,
      into_task_editorship: {{task.id}}
    });
  return false;
}
</script>